import{w as P,r as _,p as S,t as I,b as L,d as A,e as x,g as y}from"./PresentationToolGrantsCheck-22JQXROM.js";import{r as d,b as V}from"./sanity-BixSMB_v.js";function J(r){if(Array.isArray(r)){for(const e of r)if(e!=="published"&&e!=="drafts"&&!(typeof e=="string"&&e.startsWith("r")&&e!=="raw"))throw new TypeError("Invalid API perspective value, expected `published`, `drafts` or a valid release identifier string");return}switch(r){case"previewDrafts":case"drafts":case"published":case"raw":return;default:throw new TypeError("Invalid API perspective string, expected `published`, `previewDrafts` or `raw`")}}function O(r){if(J(r),Array.isArray(r))return r.includes("published")?r:[...r,"published"];switch(r){case"previewDrafts":case"drafts":return["drafts","published"];case"published":default:return["published"]}}function D(r,e){const i=O(e);function o(t){for(const a of i){let n=null;if(a.startsWith("r")&&(n=r({...t,_id:A(t._id,a)})),a==="drafts"&&(n=r({...t,_id:x(t._id)})),a==="published"&&(n=r({...t,_id:y(t._id)})),n)return{...n,_id:y(n._id),_originalId:n._id}}return null}return function(t){return o(t)}}function k(r,e,i,o,t){var h,f;if(!e)return r;const a=D(i,t),n=((f=(h=e.documents)==null?void 0:h.map)==null?void 0:f.call(h,a))||[];return P(JSON.parse(JSON.stringify(r)),(s,p)=>{const c=_(p,e);if(!c)return s;const{mapping:u,pathSuffix:m}=c;if(u.type!=="value"||u.source.type!=="documentValue")return s;const l=e.documents[u.source.document],v=e.paths[u.source.path];if(l){const b=S(v+m),E=I(b),w=n[u.source.document];if(!w)return s;const g=w?L(w,E,s):s;return s===g?s:o(g,{cachedDocument:w,previousValue:s,sourceDocument:l,sourcePath:b})}return s})}function F(r){const e=d.useMemo(()=>JSON.stringify(r||{}),[r]);return d.useMemo(()=>JSON.parse(e),[e])}function M(r){const e=V.c(16),{refreshInterval:i}=r,o=N(),[t,a]=d.useState("hit");let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=()=>(a("inflight"),()=>a("hit")),e[0]=n):n=e[0];const h=n;let f,s;e[1]!==i||e[2]!==t?(f=()=>{if(!i||t!=="hit")return;const v=setTimeout(()=>a("stale"),i);return()=>clearTimeout(v)},s=[i,t],e[1]=i,e[2]=t,e[3]=f,e[4]=s):(f=e[3],s=e[4]),d.useEffect(f,s);let p;e[5]!==t?(p=()=>{if(t!=="hit")return;const v=()=>a("stale");return window.addEventListener("focus",v),()=>window.removeEventListener("focus",v)},e[5]=t,e[6]=p):p=e[6];let c;e[7]!==i||e[8]!==t?(c=[i,t],e[7]=i,e[8]=t,e[9]=c):c=e[9],d.useEffect(p,c);let u,m;e[10]!==o||e[11]!==t?(u=()=>{o&&t==="hit"&&a("stale"),!o&&t==="stale"&&a("refresh")},m=[o,t],e[10]=o,e[11]=t,e[12]=u,e[13]=m):(u=e[12],m=e[13]),d.useEffect(u,m);let l;return e[14]!==t?(l=[t,h],e[14]=t,e[15]=l):l=e[15],l}function N(){const[r,e]=d.useState(!1);d.useEffect(()=>{e(navigator.onLine);const o=()=>e(!0),t=()=>e(!1);return window.addEventListener("online",o),window.addEventListener("offline",t),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",t)}},[]);const i=d.useSyncExternalStore(R,()=>document.visibilityState,()=>"hidden");return!r||i==="hidden"}function R(r){return document.addEventListener("visibilitychange",r),()=>document.removeEventListener("visibilitychange",r)}export{M as a,k as b,F as u};
